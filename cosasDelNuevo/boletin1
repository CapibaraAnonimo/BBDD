--1. QUEREMOS SABER CUAL ES EL PROVEEDOR QUE HA PROVISIONADO EN PROMEDIO M√ÅS PRODUCTOS QUE EL 
--PROVEEDOR QUE LO HA HECHO MENOS.

WITH promedio AS(
	SELECT AVG(quantity) "suma", company_name
	FROM order_details JOIN products USING(product_id)
		JOIN suppliers USING(supplier_id)
	GROUP BY company_name
	ORDER BY AVG(quantity)
	LIMIT 2
)
SELECT *
FROM promedio
ORDER BY suma DESC
LIMIT 1;


--2. PARA DESCARTAR PROVEEDORES NO APTOS DE NUESTRA BD, HEMOS DE TENER UN
--LISTADO DE CUALES LO SON. SE CONSIDERA QUE UN PROVEEDOR ES APTO SI EL
--PROMEDIO DE PRODUCTOS QUE HA SURTIDO ES SUPERIOR AL PROMEDIO TOTAL.






